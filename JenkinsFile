pipeline {
    agent any

    stages {
        stage('Checkout SCM') {
            steps {
                checkout scm
            }
        }
        stage('Check Docker Hub Configuration') {
            steps {
                withCredentials([usernamePassword(credentialsId: 'your-dockerhub-credentials-id', usernameVariable: 'DOCKER_USERNAME', passwordVariable: 'DOCKER_PASSWORD')]) {
                    script {
                        // Login to Docker Hub
                        sh "echo ${DOCKER_PASSWORD} | docker login -u ${DOCKER_USERNAME} --password-stdin"

                        // Pull the specific tag
                        def imageName = "raghavdiwakar/cicd:1.0"
                        def pullOutput = sh(script: "docker pull ${imageName}", returnStatus: true)
                        
                        if (pullOutput != 0) {
                            error "Docker Hub configuration check failed. Image '${imageName}' not found."
                        } else {
                            echo "Successfully pulled image '${imageName}'."
                        }
                    }
                }
            }
        }
    }
}
